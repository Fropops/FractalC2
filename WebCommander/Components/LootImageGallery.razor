@using WebCommander.Models
@inject NavigationManager NavigationManager

<div class="row">
    @foreach (var loot in Loots)
    {
        <div class="col-md-3 mb-4">
            <div class="card h-100 cursor-pointer shadow-sm loot-card" @onclick="() => OpenImage(loot)" style="cursor: pointer; transition: transform 0.2s;">
                @if (!string.IsNullOrEmpty(loot.ThumbnailData))
                {
                    <img src="data:image/png;base64,@loot.ThumbnailData" class="card-img-top" alt="@loot.FileName" style="height: 200px; object-fit: cover;">
                }
                else
                {
                    <div class="card-img-top d-flex align-items-center justify-content-center bg-light" style="height: 200px;">
                        <i class="bi bi-image text-muted" style="font-size: 3rem;"></i>
                    </div>
                }
                <div class="card-body">
                    <h6 class="card-title text-truncate" title="@loot.FileName">@loot.FileName</h6>
                </div>
            </div>
        </div>
    }
    @if (!Loots.Any())
    {
        <div class="col-12 text-center text-muted py-5">
            <i class="bi bi-images mb-3" style="font-size: 2rem;"></i>
            <p>No images found.</p>
        </div>
    }
</div>

<style>
    .loot-card:hover {
        transform: translateY(-5px);
    }
</style>

@code {
    [Parameter]
    public List<Loot> Loots { get; set; } = new();

    [Parameter]
    public string AgentId { get; set; } = string.Empty;

    private void OpenImage(Loot loot)
    {
        NavigationManager.NavigateTo($"/loots/{AgentId}/image/{Uri.EscapeDataString(loot.FileName)}");
    }
}
